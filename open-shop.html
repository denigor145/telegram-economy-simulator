<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–∫—Ä—ã—Ç–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ - –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .balance-info {
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        /* –°–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤ */
        .shops-list {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .shop-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .shop-card:hover {
            border-color: #667eea;
            background: #fff;
            transform: translateY(-2px);
        }
        
        .shop-card.premium {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6, #fff);
        }
        
        .shop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .shop-name {
            font-weight: bold;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .shop-price {
            font-size: 20px;
            font-weight: bold;
            color: #28a745;
        }
        
        .shop-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            text-align: center;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 16px;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 12px;
            color: #6c757d;
            margin-top: 3px;
        }
        
        .buy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .buy-btn:hover {
            background: #218838;
            transform: scale(1.02);
        }
        
        .buy-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º */
        .shop-management {
            padding: 20px;
            display: none;
        }
        
        .shop-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .shop-finances {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .finance-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .finance-value {
            font-weight: bold;
            font-size: 14px;
        }
        
        .finance-label {
            font-size: 11px;
            color: #6c757d;
            margin-top: 3px;
        }
        
        .positive {
            color: #28a745;
        }
        
        .negative {
            color: #dc3545;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .management-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 15px;
        }
        
        .management-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .management-tab.active {
            background: #667eea;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* –¢–æ—Ä–≥–æ–≤—ã–π –∑–∞–ª */
        .workplaces {
            margin-bottom: 20px;
        }
        
        .workplace-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .workplace-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .workplace-name {
            font-weight: bold;
            font-size: 16px;
        }
        
        .assign-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .assigned-worker {
            background: #d4edda;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }
        
        /* –°–∫–ª–∞–¥ */
        .warehouse-stats {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .products-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .product-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .product-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .product-icon {
            font-size: 24px;
        }
        
        .product-quantity {
            font-weight: bold;
            color: #667eea;
        }
        
        .buy-product-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-back {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .btn-back:hover {
            background: #5a6268;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè™ –û—Ç–∫—Ä—ã—Ç–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</h1>
            <div class="balance-info">
                –ë–∞–ª–∞–Ω—Å: <span id="currentBalance">0</span> ‚ÇΩ
            </div>
        </div>
        
        <!-- –í—ã–±–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ -->
        <div id="shopSelection" class="shops-list">
            <div class="shop-card" data-shop-type="small">
                <div class="shop-header">
                    <div class="shop-name">
                        <span>üõí</span>
                        –ú–∞–ª–µ–Ω—å–∫–∏–π –º–∞–≥–∞–∑–∏–Ω
                    </div>
                    <div class="shop-price">10,000 ‚ÇΩ</div>
                </div>
                <div class="shop-stats">
                    <div class="stat-item">
                        <div class="stat-value">2</div>
                        <div class="stat-label">–†–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">50</div>
                        <div class="stat-label">–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">500 ‚ÇΩ/–¥–µ–Ω—å</div>
                        <div class="stat-label">–ë–∞–∑–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç–∏–∂–∞</div>
                    </div>
                </div>
                <button class="buy-btn" onclick="buyShop('small', 1000, '–ú–∞–ª–µ–Ω—å–∫–∏–π –º–∞–≥–∞–∑–∏–Ω')">
                    –ö—É–ø–∏—Ç—å –∑–∞ 1,000 ‚ÇΩ
                </button>
            </div>
            
            <div class="shop-card" data-shop-type="medium">
                <div class="shop-header">
                    <div class="shop-name">
                        <span>üè¨</span>
                        –°—Ä–µ–¥–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω
                    </div>
                    <div class="shop-price">25,000 ‚ÇΩ</div>
                </div>
                <div class="shop-stats">
                    <div class="stat-item">
                        <div class="stat-value">4</div>
                        <div class="stat-label">–†–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">100</div>
                        <div class="stat-label">–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">1,200 ‚ÇΩ/–¥–µ–Ω—å</div>
                        <div class="stat-label">–ë–∞–∑–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç–∏–∂–∞</div>
                    </div>
                </div>
                <button class="buy-btn" onclick="buyShop('medium', 25000, '–°—Ä–µ–¥–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω')">
                    –ö—É–ø–∏—Ç—å –∑–∞ 25,000 ‚ÇΩ
                </button>
            </div>
            
            <div class="shop-card" data-shop-type="large">
                <div class="shop-header">
                    <div class="shop-name">
                        <span>üè¢</span>
                        –ë–æ–ª—å—à–æ–π –º–∞–≥–∞–∑–∏–Ω
                    </div>
                    <div class="shop-price">50,000 ‚ÇΩ</div>
                </div>
                <div class="shop-stats">
                    <div class="stat-item">
                        <div class="stat-value">6</div>
                        <div class="stat-label">–†–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">200</div>
                        <div class="stat-label">–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">2,500 ‚ÇΩ/–¥–µ–Ω—å</div>
                        <div class="stat-label">–ë–∞–∑–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç–∏–∂–∞</div>
                    </div>
                </div>
                <button class="buy-btn" onclick="buyShop('large', 50000, '–ë–æ–ª—å—à–æ–π –º–∞–≥–∞–∑–∏–Ω')">
                    –ö—É–ø–∏—Ç—å –∑–∞ 50,000 ‚ÇΩ
                </button>
            </div>
            
            <div class="shop-card premium" data-shop-type="premium">
                <div class="shop-header">
                    <div class="shop-name">
                        <span>üåü</span>
                        –ü—Ä–µ–º–∏—É–º –º–∞–≥–∞–∑–∏–Ω
                    </div>
                    <div class="shop-price">100,000 ‚ÇΩ</div>
                </div>
                <div class="shop-stats">
                    <div class="stat-item">
                        <div class="stat-value">8</div>
                        <div class="stat-label">–†–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">500</div>
                        <div class="stat-label">–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">5,000 ‚ÇΩ/–¥–µ–Ω—å</div>
                        <div class="stat-label">–ë–∞–∑–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Å—Ç–∏–∂–∞</div>
                    </div>
                </div>
                <button class="buy-btn" onclick="buyShop('premium', 100000, '–ü—Ä–µ–º–∏—É–º –º–∞–≥–∞–∑–∏–Ω')">
                    –ö—É–ø–∏—Ç—å –∑–∞ 100,000 ‚ÇΩ
                </button>
            </div>
        </div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º -->
        <div id="shopManagement" class="shop-management">
            <div class="shop-info">
                <h3 id="currentShopName">–ú–∞–≥–∞–∑–∏–Ω</h3>
                <div class="shop-finances">
                    <div class="finance-item">
                        <div class="finance-value positive" id="dailyIncome">+0 ‚ÇΩ</div>
                        <div class="finance-label">–î–æ—Ö–æ–¥ –≤ –¥–µ–Ω—å</div>
                    </div>
                    <div class="finance-item">
                        <div class="finance-value negative" id="dailyExpenses">-0 ‚ÇΩ</div>
                        <div class="finance-label">–†–∞—Å—Ö–æ–¥—ã –≤ –¥–µ–Ω—å</div>
                    </div>
                    <div class="finance-item">
                        <div class="finance-value" id="dailyProfit">0 ‚ÇΩ</div>
                        <div class="finance-label">–ü—Ä–∏–±—ã–ª—å –≤ –¥–µ–Ω—å</div>
                    </div>
                </div>
            </div>
            
            <div class="management-tabs">
                <div class="management-tab active" onclick="switchManagementTab('showroom')">üõçÔ∏è –¢–æ—Ä–≥–æ–≤—ã–π –∑–∞–ª</div>
                <div class="management-tab" onclick="switchManagementTab('warehouse')">üì¶ –°–∫–ª–∞–¥</div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –¢–æ—Ä–≥–æ–≤—ã–π –∑–∞–ª -->
            <div id="showroom-tab" class="tab-content active">
                <div class="workplaces">
                    <h4>–†–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞</h4>
                    <div id="workplacesList">
                        <!-- –†–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <div class="available-workers">
                    <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</h4>
                    <div id="workersList">
                        <!-- –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –°–∫–ª–∞–¥ -->
            <div id="warehouse-tab" class="tab-content">
                <div class="warehouse-stats">
                    <div>–ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å: <span id="warehouseUsage">0</span>/<span id="warehouseCapacity">0</span></div>
                    <div>–°–≤–æ–±–æ–¥–Ω–æ: <span id="warehouseFree">0</span> –º–µ—Å—Ç</div>
                </div>
                
                <div class="products-list">
                    <h4>–¢–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ</h4>
                    <div id="warehouseProducts">
                        <!-- –¢–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <div class="buy-products">
                    <h4>–ó–∞–∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</h4>
                    <div id="productsToBuy">
                        <!-- –¢–æ–≤–∞—Ä—ã –¥–ª—è –∑–∞–∫—É–ø–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <button class="btn-back" onclick="backToShopSelection()">‚Üê –ö –≤—ã–±–æ—Ä—É –º–∞–≥–∞–∑–∏–Ω–∞</button>
        </div>
        
        <button class="btn-back" onclick="goToMallEntrance()">‚Üê –í —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä</button>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="message" id="successMessage">
        –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
    </div>

    <script src="js/inventory.js"></script>
    <script>
        // –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞
        let playerShop = null;
        const shopTypes = {
            small: { workplaces: 2, capacity: 50, baseIncome: 500, level: 1 },
            medium: { workplaces: 4, capacity: 100, baseIncome: 1200, level: 2 },
            large: { workplaces: 6, capacity: 200, baseIncome: 2500, level: 3 },
            premium: { workplaces: 8, capacity: 500, baseIncome: 5000, level: 5 }
        };

        // –¢–æ–≤–∞—Ä—ã –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
        const shopProducts = [
            { id: 'bread', name: '–•–ª–µ–±', icon: 'üçû', price: 50, profit: 20 },
            { id: 'milk', name: '–ú–æ–ª–æ–∫–æ', icon: 'ü•õ', price: 80, profit: 30 },
            { id: 'eggs', name: '–Ø–π—Ü–∞', icon: 'ü•ö', price: 120, profit: 40 },
            { id: 'meat', name: '–ú—è—Å–æ', icon: 'ü•©', price: 300, profit: 100 },
            { id: 'fish', name: '–†—ã–±–∞', icon: 'üêü', price: 250, profit: 80 },
            { id: 'vegetables', name: '–û–≤–æ—â–∏', icon: 'ü•¶', price: 150, profit: 50 }
        ];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = function() {
            updateBalanceDisplay();
            updateBuyButtons();
            loadPlayerShop();
        };

        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function updateBalanceDisplay() {
            if (window.playerInventory) {
                document.getElementById('currentBalance').textContent = window.playerInventory.money.toLocaleString();
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤
        function updateBuyButtons() {
            const shopCards = document.querySelectorAll('.shop-card');
            
            shopCards.forEach(card => {
                const price = getShopPrice(card.getAttribute('data-shop-type'));
                const buyBtn = card.querySelector('.buy-btn');
                
                if (window.playerInventory.money < price) {
                    buyBtn.disabled = true;
                    buyBtn.textContent = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤';
                } else {
                    buyBtn.disabled = false;
                    buyBtn.textContent = `–ö—É–ø–∏—Ç—å –∑–∞ ${price.toLocaleString()} ‚ÇΩ`;
                }
            });
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –º–∞–≥–∞–∑–∏–Ω–∞ –ø–æ —Ç–∏–ø—É
        function getShopPrice(shopType) {
            const prices = {
                small: 1000,
                medium: 25000,
                large: 50000,
                premium: 100000
            };
            return prices[shopType] || 0;
        }

        // –ü–æ–∫—É–ø–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞
        function buyShop(shopType, price, shopName) {
            if (!window.playerInventory) {
                alert('–û—à–∏–±–∫–∞: –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                return;
            }

            if (window.playerInventory.money < price) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞!');
                return;
            }

            // –°–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–Ω—å–≥–∏
            window.playerInventory.money -= price;
            
            // –°–æ–∑–¥–∞–µ–º –º–∞–≥–∞–∑–∏–Ω
            playerShop = {
                type: shopType,
                name: shopName,
                price: price,
                purchaseDate: new Date().toISOString(),
                workplaces: Array(shopTypes[shopType].workplaces).fill(null),
                warehouse: {},
                capacity: shopTypes[shopType].capacity
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞–≥–∞–∑–∏–Ω
            savePlayerShop();
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º
            showShopManagement();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            updateBalanceDisplay();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            showMessage(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –æ—Ç–∫—Ä—ã–ª–∏ ${shopName}`);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º
        function showShopManagement() {
            document.getElementById('shopSelection').style.display = 'none';
            document.getElementById('shopManagement').style.display = 'block';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞–≥–∞–∑–∏–Ω–µ
            updateShopInfo();
            loadWorkplaces();
            loadAvailableWorkers();
            loadWarehouse();
        }

        // –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –º–∞–≥–∞–∑–∏–Ω–∞
        function backToShopSelection() {
            document.getElementById('shopSelection').style.display = 'block';
            document.getElementById('shopManagement').style.display = 'none';
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function switchManagementTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.management-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É
            event.target.classList.add('active');
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞–≥–∞–∑–∏–Ω–µ
        function updateShopInfo() {
            if (!playerShop) return;
            
            document.getElementById('currentShopName').textContent = playerShop.name;
            
            // –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤
            const income = calculateDailyIncome();
            const expenses = calculateDailyExpenses();
            const profit = income - expenses;
            
            document.getElementById('dailyIncome').textContent = `+${income.toLocaleString()} ‚ÇΩ`;
            document.getElementById('dailyExpenses').textContent = `-${expenses.toLocaleString()} ‚ÇΩ`;
            document.getElementById('dailyProfit').textContent = `${profit.toLocaleString()} ‚ÇΩ`;
            document.getElementById('dailyProfit').className = `finance-value ${profit >= 0 ? 'positive' : 'negative'}`;
        }

        // –†–∞—Å—á–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞
        function calculateDailyIncome() {
            if (!playerShop) return 0;
            
            let income = shopTypes[playerShop.type].baseIncome;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ—Ö–æ–¥ –æ—Ç —Ç–æ–≤–∞—Ä–æ–≤
            for (const productId in playerShop.warehouse) {
                const product = shopProducts.find(p => p.id === productId);
                if (product) {
                    income += playerShop.warehouse[productId] * product.profit;
                }
            }
            
            return income;
        }

        // –†–∞—Å—á–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
        function calculateDailyExpenses() {
            if (!playerShop) return 0;
            
            let expenses = 0;
            
            // –ó–∞—Ä–ø–ª–∞—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
            playerShop.workplaces.forEach(worker => {
                if (worker) {
                    // –ë–∞–∑–æ–≤–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ 200 ‚ÇΩ –≤ –¥–µ–Ω—å –∑–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞
                    expenses += 200;
                }
            });
            
            return expenses;
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞
        function loadWorkplaces() {
            if (!playerShop) return;
            
            const workplacesList = document.getElementById('workplacesList');
            workplacesList.innerHTML = '';
            
            playerShop.workplaces.forEach((worker, index) => {
                const workplaceCard = document.createElement('div');
                workplaceCard.className = 'workplace-card';
                
                workplaceCard.innerHTML = `
                    <div class="workplace-header">
                        <div class="workplace-name">–†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ ${index + 1}</div>
                        ${worker ? 
                            `<div class="assigned-worker">${worker.name}</div>` :
                            `<button class="assign-btn" onclick="openWorkerAssignment(${index})">–ù–∞–∑–Ω–∞—á–∏—Ç—å</button>`
                        }
                    </div>
                    ${worker ? `
                        <div style="font-size: 12px; color: #6c757d;">
                            –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å: ${getWorkerSpecialty(worker.id)}
                        </div>
                    ` : ''}
                `;
                
                workplacesList.appendChild(workplaceCard);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        function loadAvailableWorkers() {
            const workersList = document.getElementById('workersList');
            workersList.innerHTML = '';
            
            const hiredBots = JSON.parse(localStorage.getItem('playerHiredBots') || '[]');
            const assignedWorkers = playerShop.workplaces.filter(worker => worker !== null);
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã
            const availableWorkers = hiredBots.filter(worker => 
                !assignedWorkers.find(assigned => assigned.id === worker.id)
            );
            
            if (availableWorkers.length === 0) {
                workersList.innerHTML = '<div style="text-align: center; color: #6c757d; padding: 20px;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>';
                return;
            }
            
            availableWorkers.forEach(worker => {
                const workerElement = document.createElement('div');
                workerElement.className = 'workplace-card';
                workerElement.innerHTML = `
                    <div class="workplace-header">
                        <div class="workplace-name">${worker.name}</div>
                        <div style="font-size: 12px; color: #667eea;">${getWorkerSpecialty(worker.id)}</div>
                    </div>
                    <div style="font-size: 11px; color: #6c757d;">
                        –£—Ä–æ–≤–µ–Ω—å: ${getWorkerLevel(worker.id)} ‚Ä¢ –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞–π–º–∞: ${worker.price} ‚ÇΩ
                    </div>
                `;
                workersList.appendChild(workerElement);
            });
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞
        function getWorkerSpecialty(workerId) {
            if (workerId.includes('seller')) return '–ü—Ä–æ–¥–∞–≤–µ—Ü';
            if (workerId.includes('stocker')) return '–ö–ª–∞–¥–æ–≤—â–∏–∫';
            return '–°–æ—Ç—Ä—É–¥–Ω–∏–∫';
        }

        // –ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞
        function getWorkerLevel(workerId) {
            const level = workerId.split('_')[1];
            return level || '1';
        }

        // –ù–∞–∑–Ω–∞—á–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ
        function openWorkerAssignment(workplaceIndex) {
            const hiredBots = JSON.parse(localStorage.getItem('playerHiredBots') || '[]');
            const assignedWorkers = playerShop.workplaces.filter(worker => worker !== null);
            const availableWorkers = hiredBots.filter(worker => 
                !assignedWorkers.find(assigned => assigned.id === worker.id)
            );
            
            if (availableWorkers.length === 0) {
                alert('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è!');
                return;
            }
            
            // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –Ω–∞–∑–Ω–∞—á–∞–µ–º –ø–µ—Ä–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
            const workerToAssign = availableWorkers[0];
            playerShop.workplaces[workplaceIndex] = workerToAssign;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            savePlayerShop();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            loadWorkplaces();
            loadAvailableWorkers();
            updateShopInfo();
            
            showMessage(`${workerToAssign.name} –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ ${workplaceIndex + 1}`);
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫–ª–∞–¥
        function loadWarehouse() {
            if (!playerShop) return;
            
            const warehouseProducts = document.getElementById('warehouseProducts');
            const productsToBuy = document.getElementById('productsToBuy');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∫–ª–∞–¥–∞
            const usedCapacity = Object.values(playerShop.warehouse).reduce((sum, qty) => sum + qty, 0);
            const freeCapacity = playerShop.capacity - usedCapacity;
            
            document.getElementById('warehouseUsage').textContent = usedCapacity;
            document.getElementById('warehouseCapacity').textContent = playerShop.capacity;
            document.getElementById('warehouseFree').textContent = freeCapacity;
            
            // –¢–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ
            warehouseProducts.innerHTML = '';
            if (Object.keys(playerShop.warehouse).length === 0) {
                warehouseProducts.innerHTML = '<div style="text-align: center; color: #6c757d; padding: 20px;">–°–∫–ª–∞–¥ –ø—É—Å—Ç</div>';
            } else {
                for (const productId in playerShop.warehouse) {
                    const product = shopProducts.find(p => p.id === productId);
                    if (product) {
                        const productElement = document.createElement('div');
                        productElement.className = 'product-item';
                        productElement.innerHTML = `
                            <div class="product-info">
                                <div class="product-icon">${product.icon}</div>
                                <div>
                                    <div>${product.name}</div>
                                    <div style="font-size: 11px; color: #6c757d;">–ü—Ä–∏–±—ã–ª—å: ${product.profit} ‚ÇΩ/—à—Ç</div>
                                </div>
                            </div>
                            <div class="product-quantity">${playerShop.warehouse[productId]} —à—Ç</div>
                        `;
                        warehouseProducts.appendChild(productElement);
                    }
                }
            }
            
            // –¢–æ–≤–∞—Ä—ã –¥–ª—è –∑–∞–∫—É–ø–∫–∏
            productsToBuy.innerHTML = '';
            shopProducts.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'product-item';
                productElement.innerHTML = `
                    <div class="product-info">
                        <div class="product-icon">${product.icon}</div>
                        <div>
                            <div>${product.name}</div>
                            <div style="font-size: 11px; color: #6c757d;">–ó–∞–∫—É–ø–∫–∞: ${product.price} ‚ÇΩ</div>
                        </div>
                    </div>
                    <button class="buy-product-btn" onclick="buyProduct('${product.id}', ${product.price})">
                        –ó–∞–∫—É–ø–∏—Ç—å
                    </button>
                `;
                productsToBuy.appendChild(productElement);
            });
        }

        // –ó–∞–∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä
        function buyProduct(productId, price) {
            if (!playerShop || !window.playerInventory) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Å—Ç–æ –Ω–∞ —Å–∫–ª–∞–¥–µ
            const usedCapacity = Object.values(playerShop.warehouse).reduce((sum, qty) => sum + qty, 0);
            if (usedCapacity >= playerShop.capacity) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ!');
                return;
            }
            
            if (window.playerInventory.money < price) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥ –¥–ª—è –∑–∞–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞!');
                return;
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–Ω—å–≥–∏
            window.playerInventory.money -= price;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä –Ω–∞ —Å–∫–ª–∞–¥
            if (!playerShop.warehouse[productId]) {
                playerShop.warehouse[productId] = 0;
            }
            playerShop.warehouse[productId] += 1;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            savePlayerShop();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateBalanceDisplay();
            loadWarehouse();
            updateShopInfo();
            
            const product = shopProducts.find(p => p.id === productId);
            showMessage(`–ó–∞–∫—É–ø–ª–µ–Ω —Ç–æ–≤–∞—Ä: ${product.name}`);
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω –∏–≥—Ä–æ–∫–∞
        function savePlayerShop() {
            if (playerShop) {
                localStorage.setItem('playerShop', JSON.stringify(playerShop));
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω –∏–≥—Ä–æ–∫–∞
        function loadPlayerShop() {
            const savedShop = localStorage.getItem('playerShop');
            if (savedShop) {
                playerShop = JSON.parse(savedShop);
                showShopManagement();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text) {
            const messageElement = document.getElementById('successMessage');
            messageElement.textContent = text;
            messageElement.style.display = 'block';
            
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 2000);
        }

        // –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä
        function goToMallEntrance() {
            window.location.href = 'mall-entrance.html';
        }
    </script>
</body>
</html>
